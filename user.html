<html>

<head>
  <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"
    integrity="sha384-KAZ4DtjNhLChOB/hxXuKqhMLYvx3b5MlT55xPEiNmREKRzeEm+RVPlTnAn0ajQNs"
    crossorigin="anonymous"></script>
</head>

<body>
  <div class="join-container">
    <input class="name-input" type="text" placeholder="Name">
    <input class="room-input" type="text" placeholder="Room ID">
    <button class="join">Join room</button>
  </div>
  <button class="leave" style="display:none">Leave room</button>

  <script>
    const socket = io('http://localhost:3000/rooms');
    socket.on('connect', function () {
      console.log('Connected');
    });
      socket.on('ROOM_UPDATED', function (data) {
        console.log('ROOM_UPDATED', JSON.parse(data));
      });

                              socket.on('ROOM_LOCKED', function (data) {
                                console.log('ROOM_LOCKED', JSON.parse(data));
                              });
                              socket.on('ROOM_UNLOCKED', function (data) {
                                console.log('ROOM_UNLOCKED', JSON.parse(data));
                              });
    socket.on('exception', function (data) {
      console.log('event', data);
    });
    socket.on('disconnect', function () {
      console.log('Disconnected');
    });

  const joinButton = document.querySelector(".join")
  joinButton.addEventListener("click", () => {
    const name = document.querySelector(".name-input").value
    const roomId = document.querySelector(".room-input").value

    window.user = {
      color: '#F5F5F5',
      id: crypto.randomUUID(),
      name,
      socketId: socket.id
    }

    socket.emit('JOIN_ROOM', { roomId, user: window.user }, data => {
      console.log('JOIN_ROOM', data)
      window.room = data
      document.querySelector('.join-container').style.display = "none"
      document.querySelector('.leave').style.display = "block"
    });
  })

  const leaveButton = document.querySelector(".leave")
  leaveButton.addEventListener("click", () => {
    socket.emit('LEAVE_ROOM', { roomId, user: window.user }, data => {
      console.log('LEAVE_ROOM', data)
      window.room = data
      document.querySelector('.join-container').style.display = "block"
      document.querySelector('.leave').style.display = "none"
    });
  })
  </script>
</body>

</html>